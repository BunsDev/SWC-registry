<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>SWC-132 · Overview</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Title"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="SWC-132 · Overview"/><meta property="og:type" content="website"/><meta property="og:url" content="http://swcregistry.io/"/><meta property="og:description" content="# Title"/><meta property="og:image" content="http://swcregistry.io/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="http://swcregistry.io/img/docusaurus.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-64552723-12', 'auto');
              ga('send', 'pageview');
            </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><h2 class="headerTitle">Overview</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/SWC-100" target="_self">Registry</a></li><li class=""><a href="https://github.com/SmartContractSecurity/SWC-registry" target="_self">Github</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>SWC ID</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">SWC ID</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/SWC-100">SWC-100</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-101">SWC-101</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-102">SWC-102</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-103">SWC-103</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-104">SWC-104</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-105">SWC-105</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-106">SWC-106</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-107">SWC-107</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-108">SWC-108</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-109">SWC-109</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-110">SWC-110</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-111">SWC-111</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-112">SWC-112</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-113">SWC-113</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-114">SWC-114</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-115">SWC-115</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-116">SWC-116</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-117">SWC-117</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-118">SWC-118</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-119">SWC-119</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-120">SWC-120</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-121">SWC-121</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-122">SWC-122</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-123">SWC-123</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-124">SWC-124</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-125">SWC-125</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-126">SWC-126</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-127">SWC-127</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-128">SWC-128</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-129">SWC-129</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-130">SWC-130</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-131">SWC-131</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/SWC-132">SWC-132</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-133">SWC-133</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-134">SWC-134</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-135">SWC-135</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-136">SWC-136</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">SWC-132</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="title"></a><a href="#title" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Title</h1>
<p>Unexpected Ether balance</p>
<h2><a class="anchor" aria-hidden="true" id="relationships"></a><a href="#relationships" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Relationships</h2>
<p><a href="https://cwe.mitre.org/data/definitions/667.html">CWE-667: Improper Locking</a></p>
<h2><a class="anchor" aria-hidden="true" id="description"></a><a href="#description" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h2>
<p>Contracts can behave erroneously when they strictly assume a specific Ether balance. It is always possible to forcibly send ether to a contract (without triggering its fallback function), using selfdestruct, or by mining to the account. In the worst case scenario this could lead to DOS conditions that might render the contract unusable.</p>
<h2><a class="anchor" aria-hidden="true" id="remediation"></a><a href="#remediation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Remediation</h2>
<p>Avoid strict equality checks for the Ether balance in a contract.</p>
<h2><a class="anchor" aria-hidden="true" id="references"></a><a href="#references" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>References</h2>
<ul>
<li><a href="https://consensys.github.io/smart-contract-best-practices/known_attacks/#forcibly-sending-ether-to-a-contract">Consensys Best Practices: Forcibly Sending Ether</a></li>
<li><a href="https://blog.sigmaprime.io/solidity-security.html#ether">Sigmaprime: Unexpected Ether</a></li>
<li><a href="https://medium.com/@nmcl/gridlock-a-smart-contract-bug-73b8310608a9">Gridlock (a smart contract bug)</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="contract-samples"></a><a href="#contract-samples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Contract Samples</h2>
<h3><a class="anchor" aria-hidden="true" id="lockdropsol"></a><a href="#lockdropsol" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lockdrop.sol</h3>
<pre><code class="hljs css language-Solidity"><span class="hljs-comment">/** 
 * @source: https://github.com/hicommonwealth/edgeware-lockdrop/blob/93ecb524c9c88d25bab36278541f190fa9e910c2/contracts/Lockdrop.sol
 */</span>

pragma solidity ^<span class="hljs-number">0.5</span><span class="hljs-number">.0</span>;

<span class="hljs-class"><span class="hljs-keyword">contract</span> <span class="hljs-title">Lock</span> </span>{
    <span class="hljs-comment">// address owner; slot #0</span>
    <span class="hljs-comment">// address unlockTime; slot #1</span>
    constructor (<span class="hljs-keyword">address</span> owner, <span class="hljs-keyword">uint256</span> unlockTime) <span class="hljs-keyword">public</span> payable {
        <span class="hljs-keyword">assembly</span> {
            sstore(<span class="hljs-number">0x00</span>, owner)
            sstore(<span class="hljs-number">0x01</span>, unlockTime)
        }
    }
    
    <span class="hljs-comment">/**
     * @dev        Withdraw function once timestamp has passed unlock time
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) <span class="hljs-title"><span class="hljs-keyword">external</span></span> <span class="hljs-title">payable</span> </span>{ <span class="hljs-comment">// payable so solidity doesn't add unnecessary logic</span>
        <span class="hljs-keyword">assembly</span> {
            switch gt(timestamp, sload(<span class="hljs-number">0x01</span>))
            case <span class="hljs-number">0</span> { <span class="hljs-keyword">revert</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>) }
            case <span class="hljs-number">1</span> {
                switch <span class="hljs-built_in">call</span>(gas, sload(<span class="hljs-number">0x00</span>), balance(<span class="hljs-keyword">address</span>), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
                case <span class="hljs-number">0</span> { <span class="hljs-keyword">revert</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>) }
            }
        }
    }
}

<span class="hljs-class"><span class="hljs-keyword">contract</span> <span class="hljs-title">Lockdrop</span> </span>{
    <span class="hljs-keyword">enum</span> Term {
        ThreeMo,
        SixMo,
        TwelveMo
    }
    <span class="hljs-comment">// Time constants</span>
    <span class="hljs-keyword">uint256</span> <span class="hljs-keyword">constant</span> <span class="hljs-keyword">public</span> LOCK_DROP_PERIOD = <span class="hljs-number">1</span> <span class="hljs-literal">days</span> * <span class="hljs-number">92</span>; <span class="hljs-comment">// 3 months</span>
    <span class="hljs-keyword">uint256</span> <span class="hljs-keyword">public</span> LOCK_START_TIME;
    <span class="hljs-keyword">uint256</span> <span class="hljs-keyword">public</span> LOCK_END_TIME;
    <span class="hljs-comment">// ETH locking events</span>
    <span class="hljs-function"><span class="hljs-keyword">event</span> <span class="hljs-title">Locked</span>(<span class="hljs-params"><span class="hljs-keyword">address</span> <span class="hljs-keyword">indexed</span> owner, <span class="hljs-keyword">uint256</span> eth, Lock lockAddr, Term term, <span class="hljs-keyword">bytes</span> edgewareAddr, <span class="hljs-keyword">bool</span> isValidator, <span class="hljs-keyword">uint</span> time</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">event</span> <span class="hljs-title">Signaled</span>(<span class="hljs-params"><span class="hljs-keyword">address</span> <span class="hljs-keyword">indexed</span> contractAddr, <span class="hljs-keyword">bytes</span> edgewareAddr, <span class="hljs-keyword">uint</span> time</span>)</span>;
    
    constructor(<span class="hljs-keyword">uint</span> startTime) <span class="hljs-keyword">public</span> {
        LOCK_START_TIME = startTime;
        LOCK_END_TIME = startTime + LOCK_DROP_PERIOD;
    }

    <span class="hljs-comment">/**
     * @dev        Locks up the value sent to contract in a new Lock
     * @param      term         The length of the lock up
     * @param      edgewareAddr The bytes representation of the target edgeware key
     * @param      isValidator  Indicates if sender wishes to be a validator
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lock</span>(<span class="hljs-params">Term term, <span class="hljs-keyword">bytes</span> calldata edgewareAddr, <span class="hljs-keyword">bool</span> isValidator</span>)
        <span class="hljs-title"><span class="hljs-keyword">external</span></span>
        <span class="hljs-title">payable</span>
        <span class="hljs-title">didStart</span>
        <span class="hljs-title">didNotEnd</span>
    </span>{
        <span class="hljs-keyword">uint256</span> eth = <span class="hljs-built_in">msg</span>.value;
        <span class="hljs-keyword">address</span> owner = <span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>;
        <span class="hljs-keyword">uint256</span> unlockTime = unlockTimeForTerm(term);
        <span class="hljs-comment">// Create ETH lock contract</span>
        Lock lockAddr = (<span class="hljs-keyword">new</span> Lock).<span class="hljs-built_in">value</span>(eth)(owner, unlockTime);
        <span class="hljs-comment">// ensure lock contract has all ETH, or fail</span>
        <span class="hljs-keyword">assert</span>(<span class="hljs-keyword">address</span>(lockAddr).<span class="hljs-built_in">balance</span> == <span class="hljs-built_in">msg</span>.value);
        emit Locked(owner, eth, lockAddr, term, edgewareAddr, isValidator, <span class="hljs-built_in">now</span>);
    }

    <span class="hljs-comment">/**
     * @dev        Signals a contract's (or address's) balance decided after lock period
     * @param      contractAddr  The contract address from which to signal the balance of
     * @param      nonce         The transaction nonce of the creator of the contract
     * @param      edgewareAddr   The bytes representation of the target edgeware key
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">signal</span>(<span class="hljs-params"><span class="hljs-keyword">address</span> contractAddr, <span class="hljs-keyword">uint32</span> nonce, <span class="hljs-keyword">bytes</span> calldata edgewareAddr</span>)
        <span class="hljs-title"><span class="hljs-keyword">external</span></span>
        <span class="hljs-title">didStart</span>
        <span class="hljs-title">didNotEnd</span>
        <span class="hljs-title">didCreate</span>(<span class="hljs-params">contractAddr, <span class="hljs-built_in">msg</span>.sender, nonce</span>)
    </span>{
        emit Signaled(contractAddr, edgewareAddr, <span class="hljs-built_in">now</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unlockTimeForTerm</span>(<span class="hljs-params">Term term</span>) <span class="hljs-title"><span class="hljs-keyword">internal</span></span> <span class="hljs-title"><span class="hljs-keyword">view</span></span> <span class="hljs-title"><span class="hljs-keyword">returns</span></span> (<span class="hljs-params"><span class="hljs-keyword">uint256</span></span>) </span>{
        <span class="hljs-keyword">if</span> (term == Term.ThreeMo) <span class="hljs-keyword">return</span> <span class="hljs-built_in">now</span> + <span class="hljs-number">92</span> <span class="hljs-literal">days</span>;
        <span class="hljs-keyword">if</span> (term == Term.SixMo) <span class="hljs-keyword">return</span> <span class="hljs-built_in">now</span> + <span class="hljs-number">183</span> <span class="hljs-literal">days</span>;
        <span class="hljs-keyword">if</span> (term == Term.TwelveMo) <span class="hljs-keyword">return</span> <span class="hljs-built_in">now</span> + <span class="hljs-number">365</span> <span class="hljs-literal">days</span>;
        
        <span class="hljs-keyword">revert</span>();
    }

    <span class="hljs-comment">/**
     * @dev        Ensures the lockdrop has started
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">modifier</span> <span class="hljs-title">didStart</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">require</span>(<span class="hljs-built_in">now</span> &gt;= LOCK_START_TIME);
        _;
    }

    <span class="hljs-comment">/**
     * @dev        Ensures the lockdrop has not ended
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">modifier</span> <span class="hljs-title">didNotEnd</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">require</span>(<span class="hljs-built_in">now</span> &lt;= LOCK_END_TIME);
        _;
    }

    <span class="hljs-comment">/**
     * @dev        Rebuilds the contract address from a normal address and transaction nonce
     * @param      _origin  The non-contract address derived from a user's public key
     * @param      _nonce   The transaction nonce from which to generate a contract address
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addressFrom</span>(<span class="hljs-params"><span class="hljs-keyword">address</span> _origin, <span class="hljs-keyword">uint32</span> _nonce</span>) <span class="hljs-title"><span class="hljs-keyword">public</span></span> <span class="hljs-title"><span class="hljs-keyword">pure</span></span> <span class="hljs-title"><span class="hljs-keyword">returns</span></span> (<span class="hljs-params"><span class="hljs-keyword">address</span></span>) </span>{
        <span class="hljs-keyword">if</span>(_nonce == <span class="hljs-number">0x00</span>)     <span class="hljs-keyword">return</span> <span class="hljs-keyword">address</span>(<span class="hljs-keyword">uint160</span>(<span class="hljs-keyword">uint256</span>(keccak256(abi.encodePacked(<span class="hljs-keyword">byte</span>(<span class="hljs-number">0xd6</span>), <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x94</span>), _origin, <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x80</span>))))));
        <span class="hljs-keyword">if</span>(_nonce &lt;= <span class="hljs-number">0x7f</span>)     <span class="hljs-keyword">return</span> <span class="hljs-keyword">address</span>(<span class="hljs-keyword">uint160</span>(<span class="hljs-keyword">uint256</span>(keccak256(abi.encodePacked(<span class="hljs-keyword">byte</span>(<span class="hljs-number">0xd6</span>), <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x94</span>), _origin, <span class="hljs-keyword">uint8</span>(_nonce))))));
        <span class="hljs-keyword">if</span>(_nonce &lt;= <span class="hljs-number">0xff</span>)     <span class="hljs-keyword">return</span> <span class="hljs-keyword">address</span>(<span class="hljs-keyword">uint160</span>(<span class="hljs-keyword">uint256</span>(keccak256(abi.encodePacked(<span class="hljs-keyword">byte</span>(<span class="hljs-number">0xd7</span>), <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x94</span>), _origin, <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x81</span>), <span class="hljs-keyword">uint8</span>(_nonce))))));
        <span class="hljs-keyword">if</span>(_nonce &lt;= <span class="hljs-number">0xffff</span>)   <span class="hljs-keyword">return</span> <span class="hljs-keyword">address</span>(<span class="hljs-keyword">uint160</span>(<span class="hljs-keyword">uint256</span>(keccak256(abi.encodePacked(<span class="hljs-keyword">byte</span>(<span class="hljs-number">0xd8</span>), <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x94</span>), _origin, <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x82</span>), <span class="hljs-keyword">uint16</span>(_nonce))))));
        <span class="hljs-keyword">if</span>(_nonce &lt;= <span class="hljs-number">0xffffff</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">address</span>(<span class="hljs-keyword">uint160</span>(<span class="hljs-keyword">uint256</span>(keccak256(abi.encodePacked(<span class="hljs-keyword">byte</span>(<span class="hljs-number">0xd9</span>), <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x94</span>), _origin, <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x83</span>), <span class="hljs-keyword">uint24</span>(_nonce))))));
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">address</span>(<span class="hljs-keyword">uint160</span>(<span class="hljs-keyword">uint256</span>(keccak256(abi.encodePacked(<span class="hljs-keyword">byte</span>(<span class="hljs-number">0xda</span>), <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x94</span>), _origin, <span class="hljs-keyword">byte</span>(<span class="hljs-number">0x84</span>), <span class="hljs-keyword">uint32</span>(_nonce)))))); <span class="hljs-comment">// more than 2^32 nonces not realistic</span>
    }

    <span class="hljs-comment">/**
     * @dev        Ensures the target address was created by a parent at some nonce
     * @param      target  The target contract address (or trivially the parent)
     * @param      parent  The creator of the alleged contract address
     * @param      nonce   The creator's tx nonce at the time of the contract creation
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">modifier</span> <span class="hljs-title">didCreate</span>(<span class="hljs-params"><span class="hljs-keyword">address</span> target, <span class="hljs-keyword">address</span> parent, <span class="hljs-keyword">uint32</span> nonce</span>) </span>{
        <span class="hljs-comment">// Trivially let senders "create" themselves</span>
        <span class="hljs-keyword">if</span> (target == parent) {
            _;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">require</span>(target == addressFrom(parent, nonce));
            _;
        }
    }
}
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="lockdropyaml"></a><a href="#lockdropyaml" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lockdrop.yaml</h4>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">Gridlock</span> <span class="hljs-string">bug</span> <span class="hljs-string">in</span> <span class="hljs-string">Edgeware’s</span> <span class="hljs-string">Lockdrop</span> <span class="hljs-string">smart</span> <span class="hljs-string">contract</span>
<span class="hljs-attr">issues:</span>
<span class="hljs-attr">- id:</span> <span class="hljs-string">SWC-132</span>
<span class="hljs-attr">  count:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">  locations:</span>
<span class="hljs-attr">  - bytecode_offsets:</span> <span class="hljs-string">{}</span>
<span class="hljs-attr">    line_numbers:</span>
      <span class="hljs-string">Lockdrop.sol:</span> <span class="hljs-string">[69]</span>

</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/SWC-131"><span class="arrow-prev">← </span><span>SWC-131</span></a><a class="docs-next button" href="/docs/SWC-133"><span>SWC-133</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#relationships">Relationships</a></li><li><a href="#description">Description</a></li><li><a href="#remediation">Remediation</a></li><li><a href="#references">References</a></li><li><a href="#contract-samples">Contract Samples</a><ul class="toc-headings"><li><a href="#lockdropsol">Lockdrop.sol</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><h5>Docs</h5><a href="https://github.com/SmartContractSecurity/SWC-registry/#creating-a-new-swc-entry">How to add a new SWC entry</a><a href="https://github.com/SmartContractSecurity/SWC-registry/#creating-a-new-test-case">How to add a new Test Case</a></div><div><h5>Community</h5><a href="https://discord.gg/qcNvR2r">Join the Discord channel #swc-registry</a><a href="https://github.com/ethereum/EIPs/issues/1469">EIP-1470 discussion at ethereum/EIPs</a></div><div><h5>More</h5><a href="https://github.com/SmartContractSecurity/SWC-registry/">Back to SWC-registry repo</a></div></section><section class="copyright">Copyright © 2020 SmartContractSecurity</section><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/SmartContractSecurity/SWC-registry@website/website/scripts/lineNumbers.js"></script></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '064ab94cd5d5382009d9640000aeea98',
                indexName: 'smartcontractsecurity',
                inputSelector: '#search_input_react'
              });
            </script></body></html>