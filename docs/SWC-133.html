<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>SWC-133 · Overview</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Title"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="SWC-133 · Overview"/><meta property="og:type" content="website"/><meta property="og:url" content="http://swcregistry.io/"/><meta property="og:description" content="# Title"/><meta property="og:image" content="http://swcregistry.io/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="http://swcregistry.io/img/docusaurus.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-64552723-12', 'auto');
              ga('send', 'pageview');
            </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><h2 class="headerTitle">Overview</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/SWC-100" target="_self">Registry</a></li><li class=""><a href="https://github.com/SmartContractSecurity/SWC-registry" target="_self">Github</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>SWC ID</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">SWC ID</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/SWC-100">SWC-100</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-101">SWC-101</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-102">SWC-102</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-103">SWC-103</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-104">SWC-104</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-105">SWC-105</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-106">SWC-106</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-107">SWC-107</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-108">SWC-108</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-109">SWC-109</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-110">SWC-110</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-111">SWC-111</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-112">SWC-112</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-113">SWC-113</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-114">SWC-114</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-115">SWC-115</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-116">SWC-116</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-117">SWC-117</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-118">SWC-118</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-119">SWC-119</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-120">SWC-120</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-121">SWC-121</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-122">SWC-122</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-123">SWC-123</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-124">SWC-124</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-125">SWC-125</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-126">SWC-126</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-127">SWC-127</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-128">SWC-128</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-129">SWC-129</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-130">SWC-130</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-131">SWC-131</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-132">SWC-132</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/SWC-133">SWC-133</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-134">SWC-134</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-135">SWC-135</a></li><li class="navListItem"><a class="navItem" href="/docs/SWC-136">SWC-136</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">SWC-133</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="title"></a><a href="#title" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Title</h1>
<p>Hash Collisions With Multiple Variable Length Arguments</p>
<h2><a class="anchor" aria-hidden="true" id="relationships"></a><a href="#relationships" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Relationships</h2>
<p><a href="https://cwe.mitre.org/data/definitions/294.html">CWE-294: Authentication Bypass by Capture-replay</a></p>
<h2><a class="anchor" aria-hidden="true" id="description"></a><a href="#description" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h2>
<p>Using <code>abi.encodePacked()</code> with multiple variable length arguments can, in certain situations, lead to a hash collision. Since <code>abi.encodePacked()</code> packs all elements in order regardless of whether they're part of an array, you can move elements between arrays and, so long as all elements are in the same order, it will return the same encoding. In a signature verification situation, an attacker could exploit this by modifying the position of elements in a previous function call to effectively bypass authorization.</p>
<h2><a class="anchor" aria-hidden="true" id="remediation"></a><a href="#remediation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Remediation</h2>
<p>When using <code>abi.encodePacked()</code>, it's crucial to ensure that a matching signature cannot be achieved using different parameters. To do so, either do not allow users access to parameters used in <code>abi.encodePacked()</code>, or use fixed length arrays. Alternatively, you can simply use <code>abi.encode()</code> instead.</p>
<p>It is also recommended that you use replay protection (see <a href="/docs/SWC-121">SWC-121</a>), although an attacker can still bypass this by <a href="/docs/SWC-114">front-running</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="references"></a><a href="#references" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>References</h2>
<ul>
<li><a href="https://solidity.readthedocs.io/en/v0.5.3/abi-spec.html#non-standard-packed-mode">Solidity Non-standard Packed Mode</a></li>
<li><a href="https://learncryptography.com/hash-functions/hash-collision-attack">Hash Collision Attack</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="contract-samples"></a><a href="#contract-samples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Contract Samples</h2>
<h3><a class="anchor" aria-hidden="true" id="access_controlsol"></a><a href="#access_controlsol" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>access_control.sol</h3>
<pre><code class="hljs css language-Solidity"><span class="hljs-comment">/*
 * @author: Steve Marx
 */</span>

pragma solidity ^<span class="hljs-number">0.5</span><span class="hljs-number">.0</span>;

<span class="hljs-keyword">import</span> <span class="hljs-string">"./ECDSA.sol"</span>;

<span class="hljs-class"><span class="hljs-keyword">contract</span> <span class="hljs-title">AccessControl</span> </span>{
    <span class="hljs-keyword">using</span> ECDSA <span class="hljs-keyword">for</span> <span class="hljs-keyword">bytes32</span>;
    <span class="hljs-keyword">mapping</span>(<span class="hljs-keyword">address</span> =&gt; <span class="hljs-keyword">bool</span>) isAdmin;
    <span class="hljs-keyword">mapping</span>(<span class="hljs-keyword">address</span> =&gt; <span class="hljs-keyword">bool</span>) isRegularUser;
    <span class="hljs-comment">// Add admins and regular users.</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addUsers</span>(<span class="hljs-params">
        <span class="hljs-keyword">address</span>[] calldata admins,
        <span class="hljs-keyword">address</span>[] calldata regularUsers,
        <span class="hljs-keyword">bytes</span> calldata signature
    </span>)
        <span class="hljs-title"><span class="hljs-keyword">external</span></span>
    </span>{
        <span class="hljs-keyword">if</span> (!isAdmin[<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>]) {
            <span class="hljs-comment">// Allow calls to be relayed with an admin's signature.</span>
            <span class="hljs-keyword">bytes32</span> hash = keccak256(abi.encodePacked(admins, regularUsers));
            <span class="hljs-keyword">address</span> signer = hash.toEthSignedMessageHash().recover(signature);
            <span class="hljs-keyword">require</span>(isAdmin[signer], <span class="hljs-string">"Only admins can add users."</span>);
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">uint256</span> i = <span class="hljs-number">0</span>; i &lt; admins.<span class="hljs-built_in">length</span>; i++) {
            isAdmin[admins[i]] = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">uint256</span> i = <span class="hljs-number">0</span>; i &lt; regularUsers.<span class="hljs-built_in">length</span>; i++) {
            isRegularUser[regularUsers[i]] = <span class="hljs-literal">true</span>;
        }
    }
}
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="access_controlyaml"></a><a href="#access_controlyaml" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>access_control.yaml</h4>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">Access</span> <span class="hljs-string">control</span> <span class="hljs-string">contract</span> <span class="hljs-string">without</span> <span class="hljs-string">protection</span> <span class="hljs-string">against</span> <span class="hljs-string">multiple</span> <span class="hljs-string">variable</span> <span class="hljs-string">length</span> <span class="hljs-string">argument</span> <span class="hljs-string">hash</span> <span class="hljs-string">collisions</span>
<span class="hljs-attr">issues:</span>
<span class="hljs-attr">- id:</span> <span class="hljs-string">SWC-133</span>
<span class="hljs-attr">  count:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">  locations:</span> 
<span class="hljs-attr">  - bytecode_offsets:</span> <span class="hljs-string">{}</span>
<span class="hljs-attr">    line_numbers:</span>
      <span class="hljs-string">access_control.sol:</span> <span class="hljs-string">[23]</span>

</code></pre>
<h3><a class="anchor" aria-hidden="true" id="access_control_fixed_1sol"></a><a href="#access_control_fixed_1sol" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>access_control_fixed_1.sol</h3>
<pre><code class="hljs css language-Solidity"><span class="hljs-comment">/*
 * @author: Steve Marx
 * Modified by Kaden Zipfel
 */</span>

pragma solidity ^<span class="hljs-number">0.5</span><span class="hljs-number">.0</span>;

<span class="hljs-keyword">import</span> <span class="hljs-string">"./ECDSA.sol"</span>;

<span class="hljs-class"><span class="hljs-keyword">contract</span> <span class="hljs-title">AccessControl</span> </span>{
    <span class="hljs-keyword">using</span> ECDSA <span class="hljs-keyword">for</span> <span class="hljs-keyword">bytes32</span>;
    <span class="hljs-keyword">mapping</span>(<span class="hljs-keyword">address</span> =&gt; <span class="hljs-keyword">bool</span>) isAdmin;
    <span class="hljs-keyword">mapping</span>(<span class="hljs-keyword">address</span> =&gt; <span class="hljs-keyword">bool</span>) isRegularUser;
    <span class="hljs-comment">// Add a single user, either an admin or regular user.</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addUser</span>(<span class="hljs-params">
        <span class="hljs-keyword">address</span> user,
        <span class="hljs-keyword">bool</span> admin,
        <span class="hljs-keyword">bytes</span> calldata signature
    </span>)
        <span class="hljs-title"><span class="hljs-keyword">external</span></span>
    </span>{
        <span class="hljs-keyword">if</span> (!isAdmin[<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>]) {
            <span class="hljs-comment">// Allow calls to be relayed with an admin's signature.</span>
            <span class="hljs-keyword">bytes32</span> hash = keccak256(abi.encodePacked(user));
            <span class="hljs-keyword">address</span> signer = hash.toEthSignedMessageHash().recover(signature);
            <span class="hljs-keyword">require</span>(isAdmin[signer], <span class="hljs-string">"Only admins can add users."</span>);
        }
        <span class="hljs-keyword">if</span> (admin) {
            isAdmin[user] = <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">else</span> {
            isRegularUser[user] = <span class="hljs-literal">true</span>;
        }
    }
}
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="access_control_fixed_1yaml"></a><a href="#access_control_fixed_1yaml" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>access_control_fixed_1.yaml</h4>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">Access</span> <span class="hljs-string">control</span> <span class="hljs-string">contract</span> <span class="hljs-string">without</span> <span class="hljs-string">protection</span> <span class="hljs-string">against</span> <span class="hljs-string">multiple</span> <span class="hljs-string">variable</span> <span class="hljs-string">length</span> <span class="hljs-string">argument</span> <span class="hljs-string">hash</span> <span class="hljs-string">collisions</span>
<span class="hljs-attr">issues:</span>
<span class="hljs-attr">- id:</span> <span class="hljs-string">SWC-133</span>
<span class="hljs-attr">  count:</span> <span class="hljs-number">0</span>
<span class="hljs-attr">  locations:</span> <span class="hljs-string">[]</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="access_control_fixed_2sol"></a><a href="#access_control_fixed_2sol" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>access_control_fixed_2.sol</h3>
<pre><code class="hljs css language-Solidity"><span class="hljs-comment">/*
 * @author: Steve Marx
 * Modified by Kaden Zipfel
 */</span>

pragma solidity ^<span class="hljs-number">0.5</span><span class="hljs-number">.0</span>;

<span class="hljs-keyword">import</span> <span class="hljs-string">"./ECDSA.sol"</span>;

<span class="hljs-class"><span class="hljs-keyword">contract</span> <span class="hljs-title">AccessControl</span> </span>{
    <span class="hljs-keyword">using</span> ECDSA <span class="hljs-keyword">for</span> <span class="hljs-keyword">bytes32</span>;
    <span class="hljs-keyword">mapping</span>(<span class="hljs-keyword">address</span> =&gt; <span class="hljs-keyword">bool</span>) isAdmin;
    <span class="hljs-keyword">mapping</span>(<span class="hljs-keyword">address</span> =&gt; <span class="hljs-keyword">bool</span>) isRegularUser;
    <span class="hljs-comment">// Add admins and regular users.</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addUsers</span>(<span class="hljs-params">
        <span class="hljs-comment">// Use fixed length arrays.</span>
        <span class="hljs-keyword">address</span>[<span class="hljs-number">3</span>] calldata admins,
        <span class="hljs-keyword">address</span>[<span class="hljs-number">3</span>] calldata regularUsers,
        <span class="hljs-keyword">bytes</span> calldata signature
    </span>)
        <span class="hljs-title"><span class="hljs-keyword">external</span></span>
    </span>{
        <span class="hljs-keyword">if</span> (!isAdmin[<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>]) {
            <span class="hljs-comment">// Allow calls to be relayed with an admin's signature.</span>
            <span class="hljs-keyword">bytes32</span> hash = keccak256(abi.encodePacked(admins, regularUsers));
            <span class="hljs-keyword">address</span> signer = hash.toEthSignedMessageHash().recover(signature);
            <span class="hljs-keyword">require</span>(isAdmin[signer], <span class="hljs-string">"Only admins can add users."</span>);
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">uint256</span> i = <span class="hljs-number">0</span>; i &lt; admins.<span class="hljs-built_in">length</span>; i++) {
            isAdmin[admins[i]] = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">uint256</span> i = <span class="hljs-number">0</span>; i &lt; regularUsers.<span class="hljs-built_in">length</span>; i++) {
            isRegularUser[regularUsers[i]] = <span class="hljs-literal">true</span>;
        }
    }
}
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="access_control_fixed_2yaml"></a><a href="#access_control_fixed_2yaml" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>access_control_fixed_2.yaml</h4>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">Access</span> <span class="hljs-string">control</span> <span class="hljs-string">contract</span> <span class="hljs-string">without</span> <span class="hljs-string">protection</span> <span class="hljs-string">against</span> <span class="hljs-string">multiple</span> <span class="hljs-string">variable</span> <span class="hljs-string">length</span> <span class="hljs-string">argument</span> <span class="hljs-string">hash</span> <span class="hljs-string">collisions</span>
<span class="hljs-attr">issues:</span>
<span class="hljs-attr">- id:</span> <span class="hljs-string">SWC-133</span>
<span class="hljs-attr">  count:</span> <span class="hljs-number">0</span>
<span class="hljs-attr">  locations:</span> <span class="hljs-string">[]</span>
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/SWC-132"><span class="arrow-prev">← </span><span>SWC-132</span></a><a class="docs-next button" href="/docs/SWC-134"><span>SWC-134</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#relationships">Relationships</a></li><li><a href="#description">Description</a></li><li><a href="#remediation">Remediation</a></li><li><a href="#references">References</a></li><li><a href="#contract-samples">Contract Samples</a><ul class="toc-headings"><li><a href="#access_controlsol">access_control.sol</a></li><li><a href="#access_control_fixed_1sol">access_control_fixed_1.sol</a></li><li><a href="#access_control_fixed_2sol">access_control_fixed_2.sol</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><h5>Docs</h5><a href="https://github.com/SmartContractSecurity/SWC-registry/#creating-a-new-swc-entry">How to add a new SWC entry</a><a href="https://github.com/SmartContractSecurity/SWC-registry/#creating-a-new-test-case">How to add a new Test Case</a></div><div><h5>Community</h5><a href="https://discord.gg/qcNvR2r">Join the Discord channel #swc-registry</a><a href="https://github.com/ethereum/EIPs/issues/1469">EIP-1470 discussion at ethereum/EIPs</a></div><div><h5>More</h5><a href="https://github.com/SmartContractSecurity/SWC-registry/">Back to SWC-registry repo</a></div></section><section class="copyright">Copyright © 2020 SmartContractSecurity</section><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/SmartContractSecurity/SWC-registry@website/website/scripts/lineNumbers.js"></script></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '064ab94cd5d5382009d9640000aeea98',
                indexName: 'smartcontractsecurity',
                inputSelector: '#search_input_react'
              });
            </script></body></html>